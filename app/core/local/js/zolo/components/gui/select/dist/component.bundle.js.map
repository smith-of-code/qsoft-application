{"version":3,"file":"component.bundle.js","sources":["../../../../../../../../../assets/js/modules/select.js","../../../../mixins/StringFormatMixin.js","../src/component.js"],"sourcesContent":["import select2 from 'select2';\nimport 'jquery.nicescroll';\n\nconst ELEMENTS_SELECTOR = {\n    selectBox: '[data-select]',\n    selectControl: '[data-select-control]',\n    select2Container: '.select2-container',\n}\n\nexport default function () {\n    /**\n     * Инициализирует селекты с плагином select2\n     * @param jqObj объект JQuery (контейнер, в котором нужно проинициализировать селекты). Если не задан - инициализирует все селекты в BODY\n     */\n    function initSelect(jqObj = undefined) {\n        const baseOptions = {\n            templateResult: formatState,\n            templateSelection: formatState,\n        };\n\n        function formatState (state) {\n            let before = $(state.element).data('option-before') ? $(state.element).data('option-before') : '';\n            let after = $(state.element).data('option-after') ? $(state.element).data('option-after') : '';\n\n            let classItem = (before || after) ? 'select__item--inlined' : '';\n\n            let result = $(`\n                <span class=\"select__item ${classItem}\">\n                    ${before}\n                    ${state.text}\n                    ${after}\n                </span>\n            `);\n\n            return result;\n        };\n\n        function searchDisabled (element) {\n            let searchfield = element.parent().find('.select2-search__field');\n            searchfield.prop('disabled', true);\n        }\n\n        const scrollOptions = {\n            autohidemode: \"leave\",\n            railpadding: { top: 0, right: 0, left: 6, bottom: 0 },\n        }\n\n        var selectsContainer = $(document.body);\n\n        if (typeof jqObj != 'undefined') {\n            selectsContainer = jqObj;\n        }\n\n        selectsContainer.find(ELEMENTS_SELECTOR.selectControl).each(function(index, select) {\n            const $selectBox = $(select).closest(ELEMENTS_SELECTOR.selectBox);\n\n            const petsBreed = $selectBox.data('pets-breed');\n            if (petsBreed != undefined) {\n                baseOptions.language = {\n                    \"noResults\": ()=>{\n                        return \"Выберите тип питомца\";\n                    }\n                };\n            }\n\n            const placeholder = $(select).attr('data-placeholder');\n\n            const currentOptions = {\n                ...baseOptions,\n                placeholder,\n                dropdownParent: $selectBox,\n            };\n\n            $(select)\n                .select2(currentOptions)\n                .on('select2:open', function(e) {\n                    const $select = $(this);\n                    const $selectContainer = $select.siblings('.select2-container');\n                    const $selectList = $selectContainer.find('.select2-results__options');\n\n                    $selectList.niceScroll(scrollOptions);\n                })\n                .on('select2:close', function() {\n                    const select = $(this);\n                    const multiple = select.attr('multiple');\n\n                    if (typeof multiple !== 'undefined' && multiple !== false) {\n                        select.closest('[data-select]').find('.select2-selection__rendered').html(()=>{\n                            let counter = select.select2('data').length;\n                            if (counter > 0) {\n                                return `<li class=\"select2-selection__rendered-item\">Выбрано: ${counter}<li>`;\n                            }\n                        });\n                    }\n                })\n                .on('select2:opening select2:closing', function() {\n                    searchDisabled($(this));\n                });\n        });\n    }\n\n    initSelect();\n    window.initSelect = initSelect;\n}","export default {\n    methods: {\n        uppercaseFirst(string) {\n            return string[0].toUpperCase() + string.substring(1);\n        },\n    },\n};\n","import select from \"../../../../../../../../../assets/js/modules/select\";\nimport StringFormatMixin from \"../../../../mixins/StringFormatMixin\";\n\nlet id = 0;\n\nexport const Select = {\n    mixins: [StringFormatMixin],\n\n    data() {\n        return {\n            componentId: 'select-' + ++id,\n        };\n    },\n\n    props: {\n        name: {\n            type: String,\n            required: true,\n        },\n        placeholder: {\n            type: String,\n            default: null,\n        },\n        options: {\n            type: Object,\n            required: true,\n        },\n        selected: {\n            type: Number,\n            default: null,\n        },\n        iconed: {\n            type: Boolean,\n            default: false,\n        },\n    },\n\n    mounted() {\n        select();\n\n        $(`#${this.componentId}`).on('change', () => {\n            this.$emit('custom-change', $(`#${this.componentId}`).val());\n        });\n    },\n\n    methods: {\n        getIconPath(icon) {\n            return `<svg class=\"select__item-icon icon icon--${icon}\"><use xlink:href=\"/local/templates/.default/images/icons/sprite.svg#icon-${icon}\"></use></svg>`;\n        },\n    },\n\n    template: `\n        <div class=\"select select--mitigate\" :class=\"{ 'select--iconed': iconed }\" data-select>\n            <select class=\"select__control\" :name=\"name\" :id=\"componentId\" data-select-control :data-placeholder=\"placeholder ?? 'Выбрать'\">\n                <option><!-- пустой option для placeholder --></option>\n                <option\n                    v-for=\"(option, optionId) in options\"\n                    :key=\"optionId\"\n                    :value=\"optionId\"\n                    :data-option-before=\"iconed ? getIconPath(option.icon) : false\"\n                    :selected=\"optionId === selected\"\n                >\n                    {{ uppercaseFirst(option.name) }}\n                </option>\n            </select>\n        </div>\n    `,\n};"],"names":["ELEMENTS_SELECTOR","selectBox","selectControl","select2Container","initSelect","jqObj","undefined","baseOptions","templateResult","formatState","templateSelection","state","before","$","element","data","after","classItem","result","text","searchDisabled","searchfield","parent","find","prop","scrollOptions","autohidemode","railpadding","top","right","left","bottom","selectsContainer","document","body","each","index","select","$selectBox","closest","petsBreed","language","placeholder","attr","currentOptions","dropdownParent","select2","on","e","$select","$selectContainer","siblings","$selectList","niceScroll","multiple","html","counter","length","window","methods","uppercaseFirst","string","toUpperCase","substring","id","Select","mixins","StringFormatMixin","componentId","props","name","type","String","required","options","Object","selected","Number","iconed","Boolean","mounted","$emit","val","getIconPath","icon","template"],"mappings":";;;;;;;;;IAGA,IAAMA,iBAAiB,GAAG;MACtBC,SAAS,EAAE,eADW;MAEtBC,aAAa,EAAE,uBAFO;MAGtBC,gBAAgB,EAAE;IAHI,CAA1B;AAMA,IAAe,mBAAY;;IAE3B;IACA;IACA;MACI,SAASC,UAAT,GAAuC;QAAA,IAAnBC,KAAmB,uEAAXC,SAAW;QACnC,IAAMC,WAAW,GAAG;UAChBC,cAAc,EAAEC,WADA;UAEhBC,iBAAiB,EAAED;SAFvB;;QAKA,SAASA,WAAT,CAAsBE,KAAtB,EAA6B;UACzB,IAAIC,MAAM,GAAGC,CAAC,CAACF,KAAK,CAACG,OAAP,CAAD,CAAiBC,IAAjB,CAAsB,eAAtB,IAAyCF,CAAC,CAACF,KAAK,CAACG,OAAP,CAAD,CAAiBC,IAAjB,CAAsB,eAAtB,CAAzC,GAAkF,EAA/F;UACA,IAAIC,KAAK,GAAGH,CAAC,CAACF,KAAK,CAACG,OAAP,CAAD,CAAiBC,IAAjB,CAAsB,cAAtB,IAAwCF,CAAC,CAACF,KAAK,CAACG,OAAP,CAAD,CAAiBC,IAAjB,CAAsB,cAAtB,CAAxC,GAAgF,EAA5F;UAEA,IAAIE,SAAS,GAAIL,MAAM,IAAII,KAAX,GAAoB,uBAApB,GAA8C,EAA9D;UAEA,IAAIE,MAAM,GAAGL,CAAC,wDACkBI,SADlB,sCAEJL,MAFI,mCAGJD,KAAK,CAACQ,IAHF,mCAIJH,KAJI,6CAAd;UAQA,OAAOE,MAAP;;;QAGJ,SAASE,cAAT,CAAyBN,OAAzB,EAAkC;UAC9B,IAAIO,WAAW,GAAGP,OAAO,CAACQ,MAAR,GAAiBC,IAAjB,CAAsB,wBAAtB,CAAlB;UACAF,WAAW,CAACG,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;;;QAGJ,IAAMC,aAAa,GAAG;UAClBC,YAAY,EAAE,OADI;UAElBC,WAAW,EAAE;YAAEC,GAAG,EAAE,CAAP;YAAUC,KAAK,EAAE,CAAjB;YAAoBC,IAAI,EAAE,CAA1B;YAA6BC,MAAM,EAAE;;SAFtD;QAKA,IAAIC,gBAAgB,GAAGnB,CAAC,CAACoB,QAAQ,CAACC,IAAV,CAAxB;;QAEA,IAAI,OAAO7B,KAAP,IAAgB,WAApB,EAAiC;UAC7B2B,gBAAgB,GAAG3B,KAAnB;;;QAGJ2B,gBAAgB,CAACT,IAAjB,CAAsBvB,iBAAiB,CAACE,aAAxC,EAAuDiC,IAAvD,CAA4D,UAASC,KAAT,EAAgBC,MAAhB,EAAwB;UAChF,IAAMC,UAAU,GAAGzB,CAAC,CAACwB,MAAD,CAAD,CAAUE,OAAV,CAAkBvC,iBAAiB,CAACC,SAApC,CAAnB;UAEA,IAAMuC,SAAS,GAAGF,UAAU,CAACvB,IAAX,CAAgB,YAAhB,CAAlB;;UACA,IAAIyB,SAAS,IAAIlC,SAAjB,EAA4B;YACxBC,WAAW,CAACkC,QAAZ,GAAuB;cACnB,aAAa,qBAAI;gBACb,OAAO,sBAAP;;aAFR;;;UAOJ,IAAMC,WAAW,GAAG7B,CAAC,CAACwB,MAAD,CAAD,CAAUM,IAAV,CAAe,kBAAf,CAApB;;UAEA,IAAMC,cAAc,mCACbrC,WADa;YAEhBmC,WAAW,EAAXA,WAFgB;YAGhBG,cAAc,EAAEP;YAHpB;;UAMAzB,CAAC,CAACwB,MAAD,CAAD,CACKS,OADL,CACaF,cADb,EAEKG,EAFL,CAEQ,cAFR,EAEwB,UAASC,CAAT,EAAY;YAC5B,IAAMC,OAAO,GAAGpC,CAAC,CAAC,IAAD,CAAjB;YACA,IAAMqC,gBAAgB,GAAGD,OAAO,CAACE,QAAR,CAAiB,oBAAjB,CAAzB;YACA,IAAMC,WAAW,GAAGF,gBAAgB,CAAC3B,IAAjB,CAAsB,2BAAtB,CAApB;YAEA6B,WAAW,CAACC,UAAZ,CAAuB5B,aAAvB;WAPR,EASKsB,EATL,CASQ,eATR,EASyB,YAAW;YAC5B,IAAMV,MAAM,GAAGxB,CAAC,CAAC,IAAD,CAAhB;YACA,IAAMyC,QAAQ,GAAGjB,MAAM,CAACM,IAAP,CAAY,UAAZ,CAAjB;;YAEA,IAAI,OAAOW,QAAP,KAAoB,WAApB,IAAmCA,QAAQ,KAAK,KAApD,EAA2D;cACvDjB,MAAM,CAACE,OAAP,CAAe,eAAf,EAAgChB,IAAhC,CAAqC,8BAArC,EAAqEgC,IAArE,CAA0E,YAAI;gBAC1E,IAAIC,OAAO,GAAGnB,MAAM,CAACS,OAAP,CAAe,MAAf,EAAuBW,MAArC;;gBACA,IAAID,OAAO,GAAG,CAAd,EAAiB;kBACb,4GAAgEA,OAAhE;;eAHR;;WAdZ,EAsBKT,EAtBL,CAsBQ,iCAtBR,EAsB2C,YAAW;YAC9C3B,cAAc,CAACP,CAAC,CAAC,IAAD,CAAF,CAAd;WAvBR;SApBJ;;;MAgDJT,UAAU;MACVsD,MAAM,CAACtD,UAAP,GAAoBA,UAApB;IACH;;ACvGD,4BAAe;MACXuD,OAAO,EAAE;QACLC,cADK,0BACUC,MADV,EACkB;UACnB,OAAOA,MAAM,CAAC,CAAD,CAAN,CAAUC,WAAV,KAA0BD,MAAM,CAACE,SAAP,CAAiB,CAAjB,CAAjC;;;IAHG,CAAf;;ICGA,IAAIC,EAAE,GAAG,CAAT;AAEA,QAAaC,MAAM,GAAG;MAClBC,MAAM,EAAE,CAACC,iBAAD,CADU;MAGlBpD,IAHkB,kBAGX;QACH,OAAO;UACHqD,WAAW,EAAE,YAAY,EAAEJ;SAD/B;OAJc;MASlBK,KAAK,EAAE;QACHC,IAAI,EAAE;UACFC,IAAI,EAAEC,MADJ;UAEFC,QAAQ,EAAE;SAHX;QAKH/B,WAAW,EAAE;UACT6B,IAAI,EAAEC,MADG;UAET,WAAS;SAPV;QASHE,OAAO,EAAE;UACLH,IAAI,EAAEI,MADD;UAELF,QAAQ,EAAE;SAXX;QAaHG,QAAQ,EAAE;UACNL,IAAI,EAAEM,MADA;UAEN,WAAS;SAfV;QAiBHC,MAAM,EAAE;UACJP,IAAI,EAAEQ,OADF;UAEJ,WAAS;;OA5BC;MAgClBC,OAhCkB,qBAgCR;QAAA;;QACN3C,MAAM;QAENxB,CAAC,YAAK,KAAKuD,WAAV,EAAD,CAA0BrB,EAA1B,CAA6B,QAA7B,EAAuC,YAAM;UACzC,KAAI,CAACkC,KAAL,CAAW,eAAX,EAA4BpE,CAAC,YAAK,KAAI,CAACuD,WAAV,EAAD,CAA0Bc,GAA1B,EAA5B;SADJ;OAnCc;MAwClBvB,OAAO,EAAE;QACLwB,WADK,uBACOC,IADP,EACa;UACd,2DAAmDA,IAAnD,yFAAoIA,IAApI;;OA1CU;MA8ClBC,QAAQ;IA9CU,CAAf;;;;;;;;"}